{"ast":null,"code":"\"use strict\";\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport Head from \"next/head\";\nimport { useState, useEffect } from \"react\";\nimport Layout from \"../components/Layout\";\nimport { useFetchUser } from \"../lib/user\";\n\nvar Profile = function Profile() {\n  var getUserData = function getUserData(user) {\n    var res, json;\n    return _regeneratorRuntime.async(function getUserData$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(fetch('/api/mongodb?id=' + user.sub));\n\n          case 2:\n            res = _context.sent;\n            _context.next = 5;\n            return _regeneratorRuntime.awrap(res.json());\n\n          case 5:\n            json = _context.sent;\n            console.log(\"json\", json);\n\n            if (!json.err) {\n              _context.next = 11;\n              break;\n            }\n\n            setError({\n              error: true\n            });\n            _context.next = 20;\n            break;\n\n          case 11:\n            if (!json.isTeacher) {\n              _context.next = 19;\n              break;\n            }\n\n            _context.next = 14;\n            return _regeneratorRuntime.awrap(fetch('/api/mongodb?groupId=' + json.groupId));\n\n          case 14:\n            res = _context.sent;\n            _context.next = 17;\n            return _regeneratorRuntime.awrap(res.json());\n\n          case 17:\n            json.students = _context.sent;\n            json.students = json.students.filter(function (student) {\n              return student.isStudent;\n            });\n\n          case 19:\n            // console.log(\"json\", json)\n            setUserData(json);\n\n          case 20:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var _useFetchUser = useFetchUser(),\n      user = _useFetchUser.user,\n      loading = _useFetchUser.loading;\n\n  var _useState = useState(),\n      userData = _useState[0],\n      setUserData = _useState[1];\n\n  var _useState2 = useState(),\n      error = _useState2[0],\n      setError = _useState2[1];\n\n  if (user && !userData && !loading && !error) {\n    getUserData(user);\n  }\n\n  return __jsx(Layout, {\n    user: user,\n    loading: loading\n  }, __jsx(Head, null, __jsx(\"title\", null, \"Profile Page\"), __jsx(\"meta\", {\n    name: \"description\",\n    content: \"Profile Page\"\n  })), userData && __jsx(\"div\", {\n    id: \"main\",\n    className: \"alt\"\n  }, __jsx(\"section\", {\n    id: \"one\"\n  }, __jsx(\"div\", {\n    className: \"inner\"\n  }, __jsx(\"header\", {\n    className: \"major\"\n  }, __jsx(\"h1\", null, \"Profile\")), __jsx(\"div\", {\n    className: \"row 200%\"\n  }, __jsx(\"div\", {\n    className: \"6u 12u(medium)\"\n  }, __jsx(\"h2\", {\n    id: \"content\"\n  }, \"Nouamane Tazi\"), __jsx(\"ul\", {\n    className: \"alt\"\n  }, __jsx(\"li\", null, __jsx(\"strong\", null, \"Email :\"), \" \", userData.email), __jsx(\"li\", null, __jsx(\"strong\", null, \"Phone :\"), \" \", userData.phone)))), __jsx(\"div\", {\n    className: \"12u 12u(medium)\"\n  }, __jsx(\"h4\", null, \"Liste des \\xE9l\\xE8ves\"), __jsx(\"div\", {\n    className: \"table-wrapper\"\n  }, __jsx(\"table\", null, __jsx(\"thead\", null, __jsx(\"tr\", null, __jsx(\"th\", null, \"Nom\"), __jsx(\"th\", null, \"Demandes\"), __jsx(\"th\", null, \"Fili\\xE8re\"), __jsx(\"th\", null, \"T\\xE9l\\xE9phone\"), __jsx(\"th\", null, \"Email\"))), __jsx(\"tbody\", null, userData.students.map(function (student) {\n    return __jsx(\"tr\", null, __jsx(\"td\", null, student.name), __jsx(\"td\", null, student.wishes), __jsx(\"td\", null, student.filiere), __jsx(\"td\", null, student.phone), __jsx(\"td\", null, student.email));\n  })))))))), error && __jsx(\"div\", {\n    id: \"main\",\n    className: \"alt\"\n  }, __jsx(\"section\", {\n    id: \"one\"\n  }, __jsx(\"div\", {\n    className: \"inner\"\n  }, __jsx(\"header\", {\n    className: \"major\"\n  }, __jsx(\"h1\", null, \"Profile\")), __jsx(\"h2\", {\n    id: \"content\"\n  }, \"Profile pas encore cr\\xE9\\xE9 !\"), __jsx(\"p\", null, \"Veuillez nous contacter..\")))));\n};\n\nexport default Profile;","map":null,"metadata":{},"sourceType":"module"}